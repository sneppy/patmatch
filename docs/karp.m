% Karp figure 1

M = [10,25,50,100,250,500,1000,2500,5000];
y_10k = [0.001857,0.001856,0.001856,0.001852,0.001858,0.001867,0.001886,0.001937,0.002013];
y_25k = [0.004629,0.004625,0.00463,0.00464,0.004728,0.004841,0.004711,0.004714,0.004795];
y_50k = [0.009309,0.009211,0.009257,0.009246,0.009266,0.009277,0.009286,0.0093,0.009413];
y_100k = [0.018498,0.018486,0.018486,0.018503,0.018398,0.018565,0.018536,0.018563,0.018676];

figure;
semilogx(M,y_10k,'-*',"linewidth",2);
hold on;
semilogx(M,y_25k,'-*',"linewidth",2);
semilogx(M,y_50k,'-*',"linewidth",2);
semilogx(M,y_100k,'-*',"linewidth",2);
hold off;
title ("Karp-Rabin algorithm for random bytes sequences (k=3)");
legend({'N = 10k','N = 25k','N = 50k','N = 100k'},'Location','northeast')
xlabel("pattern length") 
ylabel("time (s)")

% Karp figure 2

k = 3:20;
y_10k = [0.001868,0.002507,0.003092,0.003847,0.004560,0.005033,0.005605,0.006229,0.006863,0.007476,0.008104,0.008736,0.009346,0.009995,0.010609,0.011252,0.011904,0.012512];
y_25k = [0.004615,0.006160,0.007744,0.009271,0.010859,0.012410,0.013955,0.015569,0.017083,0.018642,0.020226,0.021791,0.023384,0.024924,0.026459,0.028090,0.029679,0.031206];
y_50k = [0.009200,0.012277,0.015431,0.018506,0.021677,0.024770,0.028642,0.031490,0.035014,0.038020,0.042665,0.045181,0.048548,0.051530,0.054523,0.056810,0.060284,0.063792];
y_100k = [0.018586,0.024785,0.031237,0.037911,0.043664,0.050334,0.056553,0.065275,0.070733,0.076465,0.084278,0.089370,0.096306,0.102692,0.110143,0.115149,0.120066,0.126356];

figure;
plot(k,y_10k,'-*',"linewidth",2);
hold on;
plot(k,y_25k,'-*',"linewidth",2);
plot(k,y_50k,'-*',"linewidth",2);
plot(k,y_100k,'-*',"linewidth",2);
hold off;
title ("Karp-Rabin algorithm for random bytes sequences (M=50)");
legend({'N = 10k','N = 25k','N = 50k','N = 100k'},'Location','northeast')
xlabel("number of fingerprints") 
ylabel("time (s)")
